# 📖 游戏指南（新手必读）

- 开源地址：[HitWar GitHub](https://github.com/hitmux/hitwar)
- 建议阅读顺序：先看“5分钟快速上手”，再按目录查机制细节。
- 重要说明：文中很多机制用 **tick（逻辑帧）** 计时；实际“几秒”会随 **速度倍率（x0.5/x1/x2...）** 变化，建议以游戏 UI 显示与当前版本代码为准。

---

## 5分钟快速上手

1. 空格短按暂停，先看附近资源点（矿井）。
2. 在大本营附近弄几个基础炮塔，先稳住前几波。3. 立刻把附近矿井升级为 1 级矿点，确保能源开始增长。
4. 保持能源为正（尽量有盈余），再扩张领地去占更多矿点。
5. 遇到危险就暂停，优先补塔/升级关键点，别硬扛。
6. 升级雷达塔和观察塔，不仅可以保证炮塔主动攻击，还可以提前预警

---

## 目录

1. [基本操作与界面](#1-基本操作与界面)
2. [能源系统详解](#2-能源系统详解)
3. [领地系统详解](#3-领地系统详解)
4. [战争迷雾系统](#4-战争迷雾系统)
5. [塔防系统详解](#5-塔防系统详解)
6. [建筑系统](#6-建筑系统)
7. [怪物系统](#7-怪物系统)
8. [策略与技巧](#8-策略与技巧)
9. [游戏模式与功能](#9-游戏模式与功能)

---

## 1. 基本操作与界面

### 1.1 鼠标操作

- **左键点击**：
  - 选择建筑或塔
  - 建造新建筑（在可建造区域）
  - 升级建筑（看到绿色箭头时）
  - 选择塔防类型进行建造

- **右键点击**：
  - 取消当前操作
  - 取消选择

- **鼠标滚轮**：
  - 向上滚动：放大视角
  - 向下滚动：缩小视角
  - 缩放范围：最小值自动适配地图；最大约 **200%**

- **拖拽**：
  - 按住鼠标左键并移动：平移视角
  - 用于查看地图的不同区域

### 1.2 键盘快捷键

- **空格键（Space）**：
  - **短按**：暂停/继续游戏
  - **长按（200ms以上）**：临时加速3倍
  - 松开后恢复原速度

### 1.3 游戏界面

#### 速度控制面板
- **位置**：可拖拽的浮动面板
- **速度选项**：x0.5, x1, x2, x3, x5, x10
- **视图控制**：
  - 缩放按钮（+/-）
  - "回到大本营"按钮：快速返回基地位置

#### 游戏信息显示
- **左上角信息区**：金钱、怪物数量、炮塔数量、波次、TPS/FPS、能源（消耗/生产，颜色提示盈余/赤字）
- **建筑信息**：点击建筑显示详细信息

---

## 2. 能源系统详解

### 2.1 能源基础概念

能源是游戏的核心资源系统，所有塔防和部分建筑都需要消耗能源才能正常运作。

#### 能源生产
- **基地固定生产**：6（总部自动提供）
- **能量矿点生产**：
  - 1级矿点：2
  - 2级矿点：4
  - 3级矿点：6
- **生产条件**：矿点必须在有效领地内才能生产

#### 能源消耗
- **塔防消耗**：基础炮塔0.5，每升一级额外消耗 0.5
- **维修塔消耗**：0.5（必须在有效领地内）
- **消耗条件**：只有位于有效领地内的建筑才会消耗能源

### 2.2 能源平衡机制

#### 能源盈余奖励
- **奖励机制**：每隔 **133 tick**（约 2.2 秒，速度倍率会影响实际时间）触发一次奖励：如果能源盈余为 \(E>0\)，则本次奖励金币 \(+E\)。
- **示例**：如果能源盈余为 5，则每次触发奖励时获得 5 金币。

#### 能源不足惩罚
- **金币惩罚**：每隔 **40 tick**（约 0.67 秒，速度倍率会影响实际时间）触发一次惩罚：只要能源为负（赤字），本次固定扣 **1 金币**（不按赤字幅度倍增）。
- **攻击力下降**：当能源不足时，所有炮塔的攻击力会按比例下降。攻击力倍数 = 能源生产 / 能源消耗。
  - **示例**：如果能源生产为 6，消耗为 12，则攻击力倍数 = 6/12 = 0.5，即攻击力减半。
  - **影响范围**：所有位于有效领地内的炮塔都会受到影响。
- **警告**：长期能源不足会导致经济崩溃和防御力大幅下降

### 2.3 能量矿点管理

#### 矿点状态
1. **普通矿井**（黑色三角形）：
   - 初始状态，不生产能源
   - 可升级为1级矿点（费用150金币）

2. **受损矿井**（灰色三角形）：
   - 被攻击后进入受损状态
   - 需要维修（费用50金币，耗时1000 tick；速度倍率会影响实际秒数）

3. **能量矿点**（黑色正方形）：
   - 1级：生产2，血量3000，费用150
   - 2级：生产4，血量5000，费用200
   - 3级：生产6，血量10000，费用250

#### 矿点策略
- **优先升级**：开局优先将矿井升级为矿点
- **位置选择**：将矿点建在安全的后方区域
- **保护措施**：在矿点周围建造防御塔
- **升级时机**：确保有足够能源后再升级矿点

---

## 3. 领地系统详解

### 3.1 领地基础概念

领地决定了你能在哪里建造建筑，以及哪些建筑能够正常工作。

#### 领地范围
- **基础范围**：每个塔防提供半径100像素的领地范围
- **初始领地**：基地周围的小范围区域
- **领地连接**：新建筑必须与现有有效领地连接才能激活

#### 领地提供者
- **塔防**：所有塔防都能提供领地范围
- **非提供者**：能量矿点、维修塔、金矿都不提供领地，但必须在有效领地内才能工作/产出

### 3.2 有效领地与无效领地

#### 有效领地
- **定义**：与基地通过建筑链连接的领地，在游戏内的绿色区域
- **优势**：
  - 建筑正常工作
  - 矿点正常生产能源
  - 金矿正常产出金币
  - 维修塔正常维修

#### 无效领地
- **定义**：与基地失去连接的孤立领地，游戏内的黄色区域
- **惩罚机制**：
  - **矿点停止生产能源**：无效领地内的能量矿点不产生任何能源（`getEnergyProduction()` 返回 0）
  - **金矿停止产出金币**：无效领地内的金矿不产出金币（产出逻辑被跳过）
  - **维修塔治疗效果减半**：无效领地内的维修塔治疗效果降低到原来的 **50%**（`healAmount = Math.floor(originalHealAmount / 2)`）
  - **建筑血量上限降低**：所有建筑（除基地外）的血量上限降低到原来的 **50%**（`maxHp = Math.round(originalMaxHp / 2)`），当前血量同步降低
  - **塔攻击能力下降**：
    - **伤害降低**：攻击力降低到原来的 **33%**（`damageMultiplier = 1/3`）
    - **射程降低**：攻击范围降低到原来的 **67%**（`effectiveRangeR = rangeR * 2/3`）
  - **注意**：塔的伤害和射程降低是独立计算的，且会与能源不足的伤害惩罚叠加（最终伤害 = 无效领地惩罚 × 能源不足惩罚）

### 3.3 领地扩张策略

#### 扩张方法
1. **建造塔防**：每个塔防提供100像素半径的领地
2. **连接路径**：确保新建筑与现有领地连接
3. **链式扩张**：通过塔防链逐步扩张领地

#### 扩张技巧
- **路径规划**：沿着敌人路径建造塔防，既能防御又能扩张
- **关键节点**：在重要位置（如资源点）建立前哨塔
- **保护连接**：确保领地连接路径不被敌人切断
- **分阶段扩张**：不要一次性扩张太远，确保能保护新领地

---

## 4. 战争迷雾系统

### 4.1 迷雾机制

#### 迷雾覆盖
- **初始状态**：地图大部分区域被深灰色迷雾覆盖
- **视野限制**：无法看到迷雾中的敌人
- **战略意义**：增加游戏难度和策略性

#### 视野来源
- **基地视野**：半径200像素的固定视野
- **塔防视野**：每个塔防提供半径120像素的基础视野
- **观察塔视野**：
  - 1级：180像素
  - 2级：250像素
  - 3级：350像素
- **雷达塔扫描半径**（扇形扫描范围）：
  - 1级：300像素
  - 2级：550像素
  - 3级：800像素
  - 4级：1050像素
  - 5级：1300像素
- **雷达塔静态视野半径**（持续视野）：
  - 1级：125像素（基础120 + 5）
  - 2级：130像素（基础120 + 10）
  - 3级：135像素（基础120 + 15）
  - 4级：140像素（基础120 + 20）
  - 5级：145像素（基础120 + 25）

### 4.2 视野类型

#### 静态视野
- **提供者**：基地、普通塔防、观察塔
- **特点**：固定圆形视野范围
- **用途**：持续监控固定区域

#### 雷达扫描视野
- **提供者**：雷达塔
- **特点**：
  - 扇形扫描（30度角）
  - 旋转扫描（每帧0.03弧度）
  - 临时揭示（180帧，约3秒）
  - 扫描轨迹会短暂保留
- **优势**：视野范围大，适合大范围侦察
- **劣势**：扫描有延迟，可能错过快速移动的敌人

### 4.3 视野升级

#### 观察塔升级
- **每级费用**：1级60，2级120，3级180
- **累计费用**：1级60，2级180，3级360
- **策略**：适合需要持续监控的关键区域

#### 雷达塔升级
- **每级费用**：1级100，2级150，3级200，4级250，5级300
- **累计费用**：1级100，2级250，3级450，4级700，5级1000
- **策略**：适合大范围侦察和早期预警

### 4.4 迷雾策略

#### 侦察优先级
1. **敌人路径**：优先驱散敌人可能经过的路径
2. **资源点**：发现地图上的矿点和战略位置
3. **侧翼安全**：确保侧翼不被偷袭

#### 视野布局
- **前哨观察**：在扩张方向建立观察塔
- **雷达覆盖**：在关键位置建立雷达塔
- **混合使用**：观察塔+雷达塔组合使用

---

## 5. 塔防系统详解

### 5.1 塔防分类

游戏中共有**103种塔防**，分为以下类别：

#### 5.1.1 基础火力类（2种）
- **基础炮塔**：最基础的塔防，可进化为多种类型
- **古代炮塔**：中世纪风格的基础塔防
- **特点**：稳定可靠，前期支柱
- **用途**：开局过渡，后期可升级为高级塔

#### 5.1.2 激光类（14种）
- **代表**：激光塔、射线塔、脉冲激光塔
- **特点**：
  - 高频输出
  - 持续伤害
  - 无视常规防御
- **优势**：伤害高，射速快
- **劣势**：能耗较高

#### 5.1.3 锤击类（7种）
- **代表**：锤击塔、重锤塔
- **特点**：
  - 范围伤害
  - 击退效果
  - 近战攻击
- **优势**：对付成群敌人效果好
- **劣势**：攻击范围较小

#### 5.1.4 机枪类（9种）
- **代表**：机枪塔、重机枪塔、加特林塔
- **特点**：
  - 高射速
  - 单发伤害较低
  - 持续输出
- **优势**：对付快速移动目标效果好
- **劣势**：单发伤害低

#### 5.1.5 散弹类（5种）
- **代表**：散弹塔、双管散弹塔
- **特点**：
  - 多发子弹
  - 范围覆盖
  - 近距离伤害高
- **优势**：对付密集敌人效果好
- **劣势**：远距离伤害衰减

#### 5.1.6 火炮类（6种）
- **代表**：火炮塔、重炮塔、榴弹炮塔
- **特点**：
  - 高伤害
  - 爆炸范围
  - 攻击间隔较长
- **优势**：范围伤害，对付成群敌人
- **劣势**：攻击速度慢

#### 5.1.7 弓箭类（7种）
- **代表**：弓箭塔、弩箭塔、长弓塔
- **特点**：
  - 中等射速
  - 中等伤害
  - 穿透能力
- **优势**：平衡性好
- **劣势**：无明显劣势

#### 5.1.8 喷射类（5种）
- **代表**：喷射塔、毒气塔
- **特点**：
  - 持续伤害
  - 范围效果
  - 特殊效果（如中毒）
- **优势**：持续伤害，范围大
- **劣势**：需要持续输出时间

#### 5.1.9 回旋镖类（7种）
- **代表**：回旋镖塔、双回旋镖塔
- **特点**：
  - 独特轨迹
  - 往返攻击
  - 可能多次命中
- **优势**：攻击路径独特
- **劣势**：轨迹不可控

#### 5.1.10 石头类（7种）
- **代表**：投石塔、巨石塔
- **特点**：
  - 高伤害
  - 范围伤害
  - 攻击速度慢
- **优势**：伤害高
- **劣势**：攻击间隔长

#### 5.1.11 传统类（5种）
- **代表**：传统炮塔、古典炮塔
- **特点**：经典塔防风格
- **用途**：怀旧风格选择

#### 5.1.12 空气类（3种）
- **代表**：空气塔、风塔
- **特点**：
  - 特殊攻击方式
  - 可能具有控制效果
- **用途**：特殊战术选择

#### 5.1.13 雷电类（9种）
- **代表**：雷电塔、闪电塔、连锁闪电塔
- **特点**：
  - 高伤害
  - 可能连锁攻击
  - 无视防御
- **优势**：对付多个敌人效果好
- **劣势**：能耗高

#### 5.1.14 地震类（5种）
- **代表**：地震塔、震荡塔
- **特点**：
  - 大范围伤害
  - 地面攻击
  - 可能击退效果
- **优势**：范围极大
- **劣势**：攻击间隔很长

#### 5.1.15 元素类（7种）
- **代表**：火元素塔、冰元素塔、雷元素塔
- **特点**：
  - 元素伤害
  - 特殊效果
  - 可能克制关系
- **用途**：针对特定敌人

#### 5.1.16 未来类（5种）
- **代表**：未来炮塔、等离子塔
- **特点**：
  - 高科技外观
  - 高伤害
  - 特殊攻击方式
- **用途**：后期强力选择

### 5.2 塔防升级系统

#### 升级机制
- **升级条件**：点击塔防，如果显示绿色箭头 🔼，说明可以升级
- **升级选项**：每个塔防可能有多个升级分支
- **降级选项**：部分塔防可以降级（显示向下箭头）

#### 升级策略
- **优先升级核心防御塔**：将资源集中在关键位置
- **考虑升级分支**：不同分支适合不同战术
- **平衡升级**：不要只升级一种塔，保持多样性

### 5.3 塔防属性

#### 基础属性
- **攻击范围（rangeR）**：塔防能攻击的最大距离
- **攻击速度（clock）**：攻击间隔时间
- **伤害（damage）**：每次攻击造成的伤害
- **血量（hp）**：塔防的生命值

#### 特殊属性
- **子弹速度**：子弹飞行速度
- **穿透能力**：子弹能否穿透多个敌人
- **范围伤害**：爆炸或范围攻击的半径
- **特殊效果**：冰冻、中毒、击退等

---

## 6. 建筑系统

### 6.1 建筑类型

#### 6.1.1 基地（Headquarters）
- **功能**：
  - 游戏核心建筑
  - 提供固定能源生产：6
  - 提供200像素的视野范围
  - 被摧毁则游戏失败
- **属性**：
  - 血量：10000
  - 半径：20像素
- **策略**：必须重点保护

#### 6.1.2 能量矿点（Mine/Power Plant）
详见[第2章 能源系统详解](#2-能源系统详解)

#### 6.1.3 金矿（Collector）
- **功能**：定期产出金币
- **属性**：
  - 价格：800金币
  - 产出：50金币
  - 产出间隔：2000 tick（速度倍率会影响实际秒数）
  - 血量：3000
  - 半径：15像素
- **限制**：必须在有效领地内才能产出
- **策略**：
  - 建在安全的后方
  - 确保领地连接
  - 保护不被敌人攻击

#### 6.1.4 维修塔（Treatment）
- **功能**：定期治疗周围友军建筑
- **属性**：
  - 价格：1200金币
  - 治疗量：200血量
  - 治疗范围：120像素半径
  - 治疗间隔：100 tick
  - 血量：7500
  - 半径：10像素
  - 能源消耗：0.5
- **限制**：
  - 必须在有效领地内才能工作
  - 无效领地内治疗效果减半
- **策略**：
  - 建在防御塔密集区域
  - 保护关键建筑（如矿点）
  - 确保能源供应充足

### 6.2 建筑建造规则

#### 建造条件
1. **领地要求**：必须在有效领地范围内
2. **资源要求**：必须有足够的金币
3. **能源要求**：建造后不能导致能源严重不足

#### 建造限制
- **基础炮塔限制**：建造越多，费用越贵（防止卡顿）
- **位置限制**：不能与现有建筑重叠
- **连接要求**：新建筑必须与现有领地连接

---

## 7. 怪物系统

### 7.1 怪物分类

游戏中共有**37种怪物**，分为以下类别：

#### 7.1.1 基础怪物（6种）
- **特点**：血量较低，移动速度中等
- **威胁**：数量多时威胁大
- **应对**：基础火力即可应对

#### 7.1.2 精英怪物（5种）
- **特点**：高血量，移动速度较慢
- **威胁**：需要集中火力
- **应对**：高伤害塔防，如火炮、激光

#### 7.1.3 爆破怪物（4种）
- **特点**：会自爆，造成范围伤害
- **威胁**：靠近建筑时非常危险
- **应对**：远程火力优先击杀，避免近身

#### 7.1.4 防御怪物（4种）
- **特点**：高防御，可能保护其他怪物
- **威胁**：难以击杀，保护其他怪物
- **应对**：高伤害或穿透攻击

#### 7.1.5 射击怪物（4种）
- **特点**：可以远程攻击你的建筑
- **威胁**：可以攻击防御塔
- **应对**：优先击杀，保护防御塔

#### 7.1.6 史莱姆怪物（3种）
- **特点**：可能分裂或特殊移动方式
- **威胁**：数量可能增加
- **应对**：范围伤害，防止分裂

#### 7.1.7 支援怪物（5种）
- **特点**：为其他怪物提供增益
- **威胁**：增强其他怪物的威胁
- **应对**：优先击杀支援怪物

#### 7.1.8 特殊怪物（6种）
- **特点**：具有特殊能力
- **威胁**：需要特殊应对
- **应对**：根据特殊能力制定策略

### 7.2 怪物行为

#### 路径寻找
- 怪物会寻找最短路径前往基地
- 可以利用建筑引导怪物走更长路径

#### 攻击行为
- 部分怪物会攻击路径上的建筑
- 优先攻击阻挡路径的建筑

#### 特殊能力
- 某些怪物具有特殊能力（如隐身、加速、治疗等）
- 需要根据怪物类型调整策略

---

## 8. 策略与技巧

### 8.1 开局策略

#### 标准开局流程

1. **基础防御**：
   - 建造2-3个炮塔
   - 确保能应对前几波敌人

2. **建立能源**：
   - 立即将附近的矿井升级为1级矿点
   - 确保能源生产达到 8-10 左右（示例：总部6 + 1级矿点×1~2）

3. **扩张领地**：
   - 沿着敌人路径建造塔防扩张领地
   - 寻找并占领更多矿点

4. **资源积累**：
   - 建造金矿增加收入
   - 升级关键防御塔

### 8.2 塔防搭配策略

#### 混合搭配原则
- **基础火力**：用于前期过渡和持续输出
- **范围伤害**：对付成群敌人（火炮、地震、毒气）
- **高伤害**：对付精英怪（激光、雷电、火炮）
- **快速火力**：对付快速移动目标（机枪、散弹）

#### 防御层次
1. **外层**：范围伤害塔（火炮、地震）
2. **中层**：高伤害塔（激光、雷电）
3. **内层**：快速火力塔（机枪、散弹）
4. **核心**：维修塔保护关键建筑

### 8.3 路径规划

#### 延长路径技巧
- **引导建筑**：利用建筑引导敌人走S型路径
- **多层防御**：在路径上建立多层防御
- **关键节点**：在路径转折点重点防御

### 8.4 资源管理

#### 能源管理
- **保持盈余**：尽量保持能源盈余，获得奖励
- **避免不足**：避免长期能源不足，导致经济崩溃
- **提前规划**：建造新塔前计算能源消耗

#### 金币管理
- **优先投资**：优先投资能带来回报的建筑（矿点、金矿）
- **升级时机**：在安全的情况下升级塔防
- **应急储备**：保留一定金币用于紧急情况

### 8.5 视野管理

#### 侦察优先级
1. **敌人路径**：优先驱散敌人可能经过的区域
2. **资源点**：发现地图上的矿点和战略位置
3. **侧翼安全**：确保侧翼不被偷袭

#### 视野布局
- **前哨观察**：在扩张方向建立观察塔
- **雷达覆盖**：在关键位置建立雷达塔
- **混合使用**：观察塔持续监控 + 雷达塔大范围扫描

### 8.6 速度控制技巧

#### 速度使用时机
- **规划阶段**：使用x0.5或x1速度，仔细规划
- **平稳阶段**：使用x2-x3速度，加快节奏
- **等待阶段**：使用x5-x10速度，快速跳过
- **紧急情况**：暂停游戏，制定应对策略

#### 临时加速
- **空格键长按**：临时加速3倍，快速跳过等待
- **适用场景**：等待资源积累、等待敌人到来

---

## 9. 游戏模式与功能

### 9.1 游戏模式

#### 无尽模式（Endless Mode）
- **特点**：敌人波次无限，挑战你的极限
- **目标**：尽可能坚持更长时间
- **策略**：需要长期规划，平衡资源

### 9.2 作弊模式

#### 开启方式
- 点击"游戏控制"面板中的"作弊模式"按钮
- 可以开启/关闭各种作弊功能

#### 作弊功能
- **无限金币**：金币不会减少
- **无限能源**：能源消耗被禁用
- **其他功能**：可能有其他辅助功能

#### 使用建议
- **学习用途**：用于学习游戏机制和测试策略
- **娱乐用途**：体验爽快的游戏过程
- **不建议**：正式游戏时使用，会降低挑战性

### 9.3 存档系统

#### 自动存档
- **功能**：游戏会自动保存进度
- **频率**：定期自动保存
- **位置**：浏览器本地存储

#### 手动存档
- **功能**：可以手动保存游戏进度
- **用途**：在重要决策前保存，可以回退

#### 加载存档
- **功能**：可以加载之前保存的进度
- **用途**：继续之前的游戏或尝试不同策略

---

## 🎯 总结

HitWar 是一款深度策略塔防游戏，需要平衡能源、领地、视野和防御。掌握这些系统后，你将能够制定出有效的策略，应对各种挑战。

**关键要点**：
1. 能源是基础，优先保证能源供应
2. 领地为扩张，合理规划领地范围
3. 视野很重要，提前发现威胁
4. 塔防要搭配，不同情况用不同塔
5. 资源要平衡，不要过度建设

**祝你在炮塔的轰鸣声中，书写属于你的传奇！** 🎮

